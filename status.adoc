= OpenDTrace Toolkit status

The DTrace Toolkit was originally written for Solaris.
Some &mdash; but not all &mdash; of its scripts run on FreeBSD.


[cols="1,8a",options="header"]
|===
| Name | FreeBSD status

| `/dexplorer`
|
Run with `/usr/local/bin/ksh`, not `/usr/bin/ksh`. +
Adjust internal `PATH` (line 67) to include `/usr/local/bin`. +
**Fails to run** after the above: invalid probe specifiers ("no symbolic type information is available for zfs.ko`utsname").

| `/dtruss`
| Requires removal of `lstat(2)` system call (FreeBSD 11 compat only)

| `/dvmstat`
| FreeBSD does not have `vminfo` provider

| `/errinfo`
| Works out of the box

| `/execsnoop`
| Works out of the box

| `/hotkernel`
| Works out of the box

| `/hotuser`
| Works out of the box

| `/iopattern`, `/iosnoop`, `/iotop`
| These **run** after:

 * changing `/usr/bin/sh` to `/bin/sh`
 * adding `#include <sys/bio.h>`
 * changing embedded DTrace script to a heredoc (to accommodate `#include`)
 * changing `dev_statname` to `device_name`
 * removing `args[2]` (not present in FreeBSD `io:kernel::done`)
 * renaming `io:genunix::done` to `io:kernel::done`
 * renaming various `bio` fields (e.g., `b_bcount` to `bio_bcount`)

Additionally, we must remove references to `struct psinfo` and Solaris zones
from `/iotop`.

However, `/iosnoop` gives errors of the form:

----
dtrace: error on enabled probe ID 5 (ID 72577: io:kernel:none:done): invalid address (0x8) in predicate at DIF offset 16
----

|===
